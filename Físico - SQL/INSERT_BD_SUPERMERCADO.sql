USE BD_SUPERMERCADO_FUNCIONARIO_PRODUTO_CONSUMIDOR;
INSERT INTO SUPERMERCADO (SUP_CNPJ,
						  SUP_RAZAO_SOCIAL,
                          SUP_TELEFONE,
                          SUP_EMAIL,
                          SUP_ENDERECO_LOGRADOURO,
                          SUP_ENDERECO_NUMERO,
                          SUP_ENDERECO_CIDADE,
                          SUP_ENDERECO_ESTADO)
VALUES ("12345678000101",
		"Supermercado Grick",
        "199999999",
        "gricktambau@email.com",
        "Grick Street",
        "1000",
        "TambaCity",
        "SP");
        
INSERT INTO SUPERMERCADO (SUP_CNPJ,
						  SUP_RAZAO_SOCIAL,
                          SUP_TELEFONE,
                          SUP_EMAIL,
                          SUP_ENDERECO_LOGRADOURO,
                          SUP_ENDERECO_NUMERO,
                          SUP_ENDERECO_CIDADE,
                          SUP_ENDERECO_ESTADO)
VALUES ("98765432000199", "Supermercado BomPreço", "199999999", "contato@bompreco.com", "Av. das Palmeiras", "250", "Campinas", "SP");

INSERT INTO SUPERMERCADO (SUP_CNPJ,
						  SUP_RAZAO_SOCIAL,
                          SUP_TELEFONE,
                          SUP_EMAIL,
                          SUP_ENDERECO_LOGRADOURO,
                          SUP_ENDERECO_NUMERO,
                          SUP_ENDERECO_CIDADE,
                          SUP_ENDERECO_ESTADO)
VALUES ("11223344000188", "Supermercado VerdeVida", "199999999", "atendimento@verdevida.com", "Rua das Flores", "45", "Belo Horizonte", "MG");

INSERT INTO SUPERMERCADO (SUP_CNPJ,
						  SUP_RAZAO_SOCIAL,
                          SUP_TELEFONE,
                          SUP_EMAIL,
                          SUP_ENDERECO_LOGRADOURO,
                          SUP_ENDERECO_NUMERO,
                          SUP_ENDERECO_CIDADE,
                          SUP_ENDERECO_ESTADO)
VALUES ("22334455000177", "Supermercado Econômico", "199999999", "suporte@economico.com", "Av. Central", "560", "Curitiba", "PR");

INSERT INTO SUPERMERCADO (SUP_CNPJ,
						  SUP_RAZAO_SOCIAL,
                          SUP_TELEFONE,
                          SUP_EMAIL,
                          SUP_ENDERECO_LOGRADOURO,
                          SUP_ENDERECO_NUMERO,
                          SUP_ENDERECO_CIDADE,
                          SUP_ENDERECO_ESTADO)
VALUES ("33445566000166", "Supermercado PagueMenos", "199999999", "paguemenos@compras.com", "Rua João Pessoa", "89", "Porto Alegre", "RS");

INSERT INTO PRODUTO(PRO_CODIGO_BARRAS,
					PRO_NOME,
                    PRO_PESO,
                    PRO_QUANTIDADE,
                    PRO_PRECO,
                    PRO_DATA_VALIDADE)
VALUES ("129371238", "Arroz 5kg", 5.0, 500, 26.90, "2025-12-25");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS,
                     PRO_NOME,
                     PRO_PESO,
                     PRO_QUANTIDADE,
                     PRO_PRECO,
                     PRO_DATA_VALIDADE)
VALUES ("873264982", "Feijão Carioca 1kg", 1.0, 300, 8.49, "2026-02-10");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS,
                     PRO_NOME,
                     PRO_PESO,
                     PRO_QUANTIDADE,
                     PRO_PRECO,
                     PRO_DATA_VALIDADE)
VALUES ("564738291", "Açúcar Refinado 2kg", 2.0, 400, 6.79, "2026-05-15");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS,
                     PRO_NOME,
                     PRO_PESO,
                     PRO_QUANTIDADE,
                     PRO_PRECO,
                     PRO_DATA_VALIDADE)
VALUES ("908172635", "Macarrão Espaguete 500g", 0.5, 250, 4.59, "2026-01-20");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS,
                     PRO_NOME,
                     PRO_PESO,
                     PRO_QUANTIDADE,
                     PRO_PRECO,
                     PRO_DATA_VALIDADE)
VALUES ("453627189", "Óleo de Soja 900ml", 0.9, 350, 7.29, "2025-11-30");

INSERT INTO CONSUMIDOR(CON_CPF,
					   CON_NOME,
                       CON_TELEFONE,
                       CON_EMAIL)
VALUES ("12345678901", "Mariana Alves", "(11) 98765-4321", "mariana.alves@email.com");

INSERT INTO CONSUMIDOR(CON_CPF,
					   CON_NOME,
                       CON_TELEFONE,
                       CON_EMAIL)
VALUES ("23456789012", "João Pedro Silva", "(21) 99876-5432", "joaopedro.silva@email.com");

INSERT INTO CONSUMIDOR(CON_CPF,
					   CON_NOME,
                       CON_TELEFONE,
                       CON_EMAIL)
VALUES ("34567890123", "Carla Menezes", "(31) 91234-5678", "carla.menezes@email.com");

INSERT INTO CONSUMIDOR(CON_CPF,
					   CON_NOME,
                       CON_TELEFONE,
                       CON_EMAIL)
VALUES ("45678901234", "Rafael Costa", "(41) 98712-3456", "rafael.costa@email.com");

INSERT INTO CONSUMIDOR(CON_CPF,
					   CON_NOME,
                       CON_TELEFONE,
                       CON_EMAIL)
VALUES ("56789012345", "Ana Beatriz Souza", "(51) 99123-4567", "ana.souza@email.com");

INSERT INTO FUNCIONARIO(FUN_CPF,
						FUN_NOME,
                        FUN_DATA_NASCIMENTO,
                        FUN_TELEFONE,
                        FUN_EMAIL,
                        FUN_CARTEIRA_TRABALHO,
                        FUN_BANCO_AGENCIA,
                        FUN_BANCO_CONTA,
                        FUN_DATA_ADMISSAO,
                        FUN_JORNADA_TRABALHO,
                        FK_SUP_CNPJ)
VALUES ("12345678900", "Lucas Ferreira", "1990-03-12", "(11) 98877-2233", "lucas.ferreira@grick.com", "CTPS12345SP", "0001", "123456-7", "2020-02-15", "44h semanais", "12345678000101");

INSERT INTO FUNCIONARIO(FUN_CPF,
						FUN_NOME,
                        FUN_DATA_NASCIMENTO,
                        FUN_TELEFONE,
                        FUN_EMAIL,
                        FUN_CARTEIRA_TRABALHO,
                        FUN_BANCO_AGENCIA,
                        FUN_BANCO_CONTA,
                        FUN_DATA_ADMISSAO,
                        FUN_JORNADA_TRABALHO,
                        FK_SUP_CNPJ)
VALUES ("23456789011", "Juliana Martins", "1988-07-25", "(21) 97766-3344", "juliana.martins@bompreco.com", "CTPS67890SP", "0002", "234567-8", "2019-09-01", "40h semanais", "98765432000199");

INSERT INTO FUNCIONARIO(FUN_CPF,
						FUN_NOME,
                        FUN_DATA_NASCIMENTO,
                        FUN_TELEFONE,
                        FUN_EMAIL,
                        FUN_CARTEIRA_TRABALHO,
                        FUN_BANCO_AGENCIA,
                        FUN_BANCO_CONTA,
                        FUN_DATA_ADMISSAO,
                        FUN_JORNADA_TRABALHO,
                        FK_SUP_CNPJ)
VALUES ("34567890122", "Carlos Andrade", "1995-01-08", "(31) 98855-1122", "carlos.andrade@verdevida.com", "CTPS34567MG", "0003", "345678-9", "2021-05-20", "44h semanais", "11223344000188");

INSERT INTO FUNCIONARIO(FUN_CPF,
						FUN_NOME,
                        FUN_DATA_NASCIMENTO,
                        FUN_TELEFONE,
                        FUN_EMAIL,
                        FUN_CARTEIRA_TRABALHO,
                        FUN_BANCO_AGENCIA,
                        FUN_BANCO_CONTA,
                        FUN_DATA_ADMISSAO,
                        FUN_JORNADA_TRABALHO,
                        FK_SUP_CNPJ)
VALUES ("45678901233", "Patrícia Oliveira", "1992-11-19", "(41) 99944-5566", "patricia.oliveira@economico.com", "CTPS45678PR", "0004", "456789-0", "2018-03-10", "36h semanais", "22334455000177");

INSERT INTO FUNCIONARIO(FUN_CPF,
						FUN_NOME,
                        FUN_DATA_NASCIMENTO,
                        FUN_TELEFONE,
                        FUN_EMAIL,
                        FUN_CARTEIRA_TRABALHO,
                        FUN_BANCO_AGENCIA,
                        FUN_BANCO_CONTA,
                        FUN_DATA_ADMISSAO,
                        FUN_JORNADA_TRABALHO,
                        FK_SUP_CNPJ)
VALUES ("56789012344", "Eduardo Souza", "1985-06-30", "(51) 98733-7788", "eduardo.souza@paguemenos.com", "CTPS56789RS", "0005", "567890-1", "2017-07-05", "44h semanais", "33445566000166");

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES
("12345678000101", 1), 
("98765432000199", 2), 
("11223344000188", 3), 
("22334455000177", 4), 
("33445566000166", 5); 

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES
("12345678901", 1), 
("23456789012", 2), 
("34567890123", 3), 
("45678901234", 4),
("56789012345", 5); 

SELECT * FROM SUPERMERCADO;

 -- Consultar o aumento de R$2,00 no preço dos produtos com preço atual >=  R$5,00
 
 SELECT PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
        PRO_PRECO AS "PREÇO ATUAL",
        TRUNCATE((PRO_PRECO + 2),2) AS "PREÇO COM AJUSTE DE R$2,00"
FROM PRODUTO
WHERE PRO_PRECO >= 5;

-- Consultar a redução de R$1,00 no preço dos produtos com preço atual abaixo de R$5,00

SELECT PRO_NOME AS "NOME",
	   PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_PRECO AS "PREÇO ATUAL",
       TRUNCATE((PRO_PRECO - 1),2) AS "PREÇO COM REDUÇÃO DE R$1,00"
FROM PRODUTO
WHERE PRO_PRECO <= 5;

-- Consultar como seria aplicar um desconto de 10% em todos os produtos

SELECT PRO_NOME AS "NOME",
	   PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_PRECO AS "PREÇO ATUAL",
       (PRO_PRECO - (PRO_PRECO * 0.1)) AS "PREÇO COM DESCONTO DE 10%"
FROM PRODUTO;

-- Ajustar o estoque do primeiro produto dividindo pela metade

SELECT PRO_ID,
	   PRO_NOME,	
	   PRO_CODIGO_BARRAS,
       PRO_QUANTIDADE
FROM PRODUTO;

UPDATE PRODUTO
SET PRO_QUANTIDADE = PRO_QUANTIDADE/2
WHERE PRO_ID = 1;

-- Consultar todos os produtos que tenham data de validade entre setembro de 2025 e dezembro de 2025
SELECT PRO_NOME AS "NOME",
	   PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_DATA_VALIDADE AS "DATA DE VALIDADE"
FROM PRODUTO
WHERE PRO_DATA_VALIDADE BETWEEN '2025-09-01' AND '2025-12-31';

-- Consultar todos os produtos que tenham preço maior que R$10,00 ou menor que R$4,00
SELECT PRO_NOME AS"NOME",
	   PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_PRECO AS "PREÇO"
FROM PRODUTO
WHERE PRO_PRECO >= 10 OR PRO_PRECO <= 4;

-- Consultar os DDD's e telefones dos consumidores separadamente
SELECT CON_NOME AS "NOME DO CONSUMIDOR",
	   CON_CPF AS "CPF DO CONSUMIDOR",
       SUBSTRING(CON_TELEFONE,2,2) AS "DDD DO TELEFONE",
       SUBSTRING(CON_TELEFONE,5,12) AS "NUMERO TELEFONE"
FROM CONSUMIDOR;

-- Gerar uma frase concatenando: razão social, cnpj, telefone, e email
SELECT CONCAT("Razão Social: ",CONCAT(SUP_RAZAO_SOCIAL,CONCAT(" | CNPJ: ",CONCAT(SUP_CNPJ,CONCAT(" | TELEFONE: ",CONCAT(SUP_TELEFONE,CONCAT(" | EMAIL: ",CONCAT(SUP_EMAIL)))))))) AS FRASE
FROM SUPERMERCADO;

/*
Gerar uma consulta que verifica o peso dos produtos, retornar: nome, código de barras, quantidade, peso e data de validade
Regras:
1) peso <= 5: peso baixo
2) peso > 5 e peso <=50: peso médio
3) peso > 50: peso alto
*/
SELECT PRO_NOME AS "NOME DO PRODUTO",
       PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_QUANTIDADE AS "QUANTIDADE",
       PRO_DATA_VALIDADE AS "DATA DE VALIDADE",
       PRO_PESO AS "PESO DO PRODUTO",
       CASE
		   WHEN PRO_PESO <= 5 THEN "PESO BAIXO"
           WHEN PRO_PESO > 5 AND PRO_PESO <=50 THEN "PESO MÉDIO"
           WHEN PRO_PESO > 50 THEN "PESO ALTO"
	   END AS "CLASSIFCAÇÃO DO PESO"
FROM PRODUTO;

-- Contar quantos consumidores, supermercados, funcionários e produtos temos cadastrados
SELECT COUNT(*)
FROM CONSUMIDOR;

SELECT COUNT(*)
FROM SUPERMERCADO;

SELECT COUNT(*)
FROM FUNCIONARIO;

SELECT COUNT(*)
FROM PRODUTO;

-- Somar o preço total de todos os produtos cadastrados
SELECT SUM(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$ ", TRUNCATE(SUM(PRO_PRECO),2)) AS "SOMA TOTAL"
FROM PRODUTO;

-- Calcular a média de preços dos produtos
SELECT AVG(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$ ", TRUNCATE(AVG(PRO_PRECO),2)) AS "MÉDIA DE PREÇO"
FROM PRODUTO;

-- Selecionar o produto mais caro
SELECT MAX(PRO_PRECO)
FROM PRODUTO;

-- Selecionar o estoque com maior quantidade
SELECT MAX(PRO_QUANTIDADE)
FROM PRODUTO;

-- Selecionar o produto mais barato
SELECT MIN(PRO_PRECO)
FROM PRODUTO;

-- Selecionar o estoque com menor quantidade
SELECT MIN(PRO_QUANTIDADE)
FROM PRODUTO;

-- Selecionar a data e hora atual
SELECT NOW() FROM DUAL;

SELECT FUN_NOME AS "NOME DO FUNCIONARIO",
	   DATE_FORMAT(FUN_DATA_NASCIMENTO, "%d/%m/%Y") AS "DATA DE NASCIMENTO",
       TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM FUNCIONARIO;

/* 
Funções matemáticas:
abs - valor absoluto de um número
round - arredondar
power - potência 
*/
SELECT ABS(-10),
	   ROUND(PRO_PRECO) AS "PREÇO ARREDONDADO",
       POWER(PRO_PRECO,2) AS "PREÇOS ELEVADOS AO QUADRADO"
FROM PRODUTO;

-- UPPER, LOWER, TRIM
SELECT UPPER(FUN_NOME) AS "MAIÚSCULAS",
	   LOWER(FUN_NOME) AS "MINÚSCULAS",
       TRIM("           Vini") AS "TIRANDO ESPAÇOS"
FROM FUNCIONARIO;

-- GROUP BY
SELECT PRO_QUANTIDADE,
	   COUNT(*) AS "Repetições"
FROM PRODUTO
GROUP BY PRO_QUANTIDADE;

-- UNION
SELECT FUN_NOME,
	   FUN_CPF
FROM FUNCIONARIO
UNION
SELECT FUN_NOME,
	   FUN_CPF
FROM FUNCIONARIO;

SELECT * FROM PRODUTO;

SELECT PRO_NOME
FROM PRODUTO
UNION 
SELECT "Arroz 5kg"
FROM DUAL
UNION
SELECT "Iorgute do Bob Esponja"
FROM DUAL;

SELECT PRO_NOME
FROM PRODUTO
UNION ALL
SELECT "Arroz 5kg"
FROM DUAL
UNION ALL
SELECT "Iorgute do Bob Esponja"
FROM DUAL;

-- SELECT COM WHERE
SELECT FUN_NOME AS "NOME DO FUNCIONÁRIO",
	   FUN_CPF AS "CPF DO FUNCIONÁRIO",
       FUN_DATA_NASCIMENTO AS "DATA DE NASCIMENTO",
       TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM FUNCIONARIO
WHERE TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) >= 25 
AND TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) <= 35;

-- RETORNAR OS SUPERMERCADOS, FUNCIONÁRIOS E OS CONSUMIDORES, QUE O EMAIL DELES É hotmail OU outlook
SELECT CON_NOME AS "NOME",
       CON_CPF AS "CPF/CNPJ",
       CON_TELEFONE AS "TELEFONE",
       CON_EMAIL AS "EMAIL",
       "CONSUMIDOR" AS "TIPO"
FROM CONSUMIDOR
WHERE UPPER(CON_EMAIL) LIKE "%EMAIL%"
OR UPPER(CON_EMAIL) LIKE "%OUTLOOK%"
UNION
SELECT FUN_NOME AS "NOME",
       FUN_CPF AS "CPF/CNPJ",
	   FUN_TELEFONE AS "TELEFONE",
       FUN_EMAIL AS "EMAIL",
       "FUNCIONÁRIO" AS "TIPO"
FROM FUNCIONARIO
WHERE UPPER(FUN_EMAIL) LIKE "%EMAIL%"
OR UPPER(FUN_EMAIL) LIKE "%OUTLOOK%"
UNION
SELECT SUP_RAZAO_SOCIAL AS "NOME",
	   SUP_CNPJ AS "CPF/CNPJ",
       SUP_TELEFONE AS "TELEFONE",
       SUP_EMAIL AS "EMAIL",
       "SUPERMERCADO" AS "TIPO"
FROM SUPERMERCADO
WHERE UPPER(SUP_EMAIL) LIKE "%EMAIL%"
OR UPPER(SUP_EMAIL) LIKE "%OUTLOOK%";

-- CROSS JOIN: RETORNAR TODOS OS PRODUTOS E OS SUPERMERCADOS EM QUE SÃO VENDIDOS
SELECT PRODUTO.PRO_NOME AS "NOME",
	   PRODUTO.PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL"
FROM SUPERMERCADO_PRODUTO
CROSS JOIN SUPERMERCADO
CROSS JOIN PRODUTO
WHERE PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID
AND SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ;

-- INNER JOIN: RETORNAR APENAS OS PRODUTOS QUE FORAM COMPRADOS POR ALGUM CONSUMIDOR
SELECT PRODUTO_CONSUMIDOR.PCO_ID AS "ID DA COMPRA",
	   PRODUTO.PRO_NOME AS "NOME DO PRODUTO",
       PRODUTO.PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR",
       CONSUMIDOR.CON_CPF AS "CPF DO CONSUMIDOR"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

-- EXERCÍCIO COM INNER JOIN: RETORNAR APENAS OS FUNCIONÁRIOS QUE TRABALHAM EM UM SUPERMERCADO, RETORNAR O NOME DO FUNCIONÁRIO E O NOME DO SUPERMERCADO QUE ELE TRABALHA
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL",
	   FUNCIONARIO.FUN_NOME AS "NOME DO FUNCIONÁRIO"
FROM SUPERMERCADO
INNER JOIN FUNCIONARIO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

-- EXERCÍCIO 2 INNER JOIN: RETORNAR APENAS OS PRODUTOS QUE EXISTAM EM UM SUPERMERCADO, RETORNAR O NOME DO PRODUTO E O NOME DO SUPERMERCADO QUE ELE ESTÁ DISPONÍVEL
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL",
       PRODUTO.PRO_NOME AS "NOME DO PRODUTO"
FROM SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

-- LEFT JOIN
INSERT INTO PRODUTO(PRO_CODIGO_BARRAS,
					PRO_NOME,
                    PRO_PESO,
                    PRO_QUANTIDADE,
                    PRO_PRECO,
                    PRO_DATA_VALIDADE)
VALUE 			   ("333333333",
					"KitKat",
                    "30",
                    "1500",
                    4.50,
                    "2026-01-01");
                    
SELECT PRODUTO.PRO_NOME,
	   SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO
LEFT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
LEFT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

SELECT * FROM SUPERMERCADO;

SELECT PRODUTO.PRO_NOME,
	   SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO
RIGHT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
RIGHT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

-- SELECT COM LEFT JOIN E RIGHT JOIN
SELECT *
FROM (
		SELECT S.SUP_RAZAO_SOCIAL AS RAZAO_SOCIAL,
			   F.FUN_NOME 		  AS NOME_FUNCIONARIO,
               P.PRO_NOME 	      AS NOME_PRODUTO,
               C.CON_NOME         AS NOME_CONSUMIDOR
		FROM   SUPERMERCADO S 
        LEFT JOIN FUNCIONARIO F           ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        LEFT JOIN SUPERMERCADO_PRODUTO SP ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        LEFT JOIN PRODUTO P               ON (SP.FK_PRO_ID = P.PRO_ID)
        LEFT JOIN PRODUTO_CONSUMIDOR PC   ON (P.PRO_ID = PC.FK_PRO_ID)
        LEFT JOIN CONSUMIDOR C            ON (PC.FK_CON_CPF = C.CON_CPF)
        UNION
        SELECT S.SUP_RAZAO_SOCIAL AS RAZAO_SOCIAL,
			   F.FUN_NOME 		  AS NOME_FUNCIONARIO,
               P.PRO_NOME 	      AS NOME_PRODUTO,
               C.CON_NOME         AS NOME_CONSUMIDOR
		FROM   SUPERMERCADO S 
        RIGHT JOIN FUNCIONARIO F           ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        RIGHT JOIN SUPERMERCADO_PRODUTO SP ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        RIGHT JOIN PRODUTO P               ON (SP.FK_PRO_ID = P.PRO_ID)
        RIGHT JOIN PRODUTO_CONSUMIDOR PC   ON (P.PRO_ID = PC.FK_PRO_ID)
        RIGHT JOIN CONSUMIDOR C            ON (PC.FK_CON_CPF = C.CON_CPF)
) SELECT_EXTERNO
	ORDER BY SELECT_EXTERNO.RAZAO_SOCIAL     ASC,
			 SELECT_EXTERNO.NOME_FUNCIONARIO DESC,
             SELECT_EXTERNO.NOME_PRODUTO     ASC,
             SELECT_EXTERNO.NOME_CONSUMIDOR  DESC;

-- EXERCÍCIOS INNER JOIN: 1
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL",
       PRODUTO.PRO_NOME AS "NOME DO PRODUTO"
FROM SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

-- EXERCÍCIO 2
SELECT FUNCIONARIO.FUN_NOME AS "NOME DO FUNCIONÁRIO",
	   SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL"
FROM SUPERMERCADO
INNER JOIN FUNCIONARIO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

-- EXERCÍCIO 3 
SELECT CONSUMIDOR.CON_NOME AS "NOME CONSUMIDOR",
	   PRODUTO.PRO_NOME AS "NOME PRODUTO"
FROM PRODUTO_CONSUMIDOR
INNER JOIN CONSUMIDOR ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF)
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID);

-- EXERCÍCIO 4
SELECT PRODUTO.PRO_NOME AS "NOME PRODUTO",
	   CONSUMIDOR.CON_NOME AS "NOME CONSUMIDOR"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID)
INNER JOIN CONSUMIDOR ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF);

-- EXERCÍCIO 5
SELECT 	SUPERMERCADO.SUP_RAZAO_SOCIAL AS "NOME DO SUPERMERCADO",
	    COUNT(*) AS "QUANTIDADE PRODUTO"
FROM SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
GROUP BY SUPERMERCADO.SUP_RAZAO_SOCIAL;

-- EXERCÍCIOS LEFT JOIN: 1
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL,
	   PRODUTO.PRO_NOME
FROM SUPERMERCADO
LEFT JOIN SUPERMERCADO_PRODUTO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
LEFT JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID);


-- EXERCÍCIO 2
SELECT FUNCIONARIO.FUN_NOME,
       SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM FUNCIONARIO
LEFT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

-- EXERCÍCIO 3
SELECT CONSUMIDOR.CON_NOME,
	   PRODUTO.PRO_NOME
FROM PRODUTO_CONSUMIDOR
LEFT JOIN PRODUTO ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID)
LEFT JOIN CONSUMIDOR ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF);

-- EXERCÍCIO 4
SELECT PRODUTO.PRO_NOME,
	   CONSUMIDOR.CON_NOME
FROM PRODUTO_CONSUMIDOR
LEFT JOIN PRODUTO ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID)
LEFT JOIN CONSUMIDOR ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF);

-- EXERCÍCIO 5
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL,
	   FUNCIONARIO.FUN_NOME
FROM SUPERMERCADO
LEFT JOIN FUNCIONARIO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

-- EXERCÍCIOS RIGHT JOIN: 1
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL,
	   PRODUTO.PRO_NOME
FROM PRODUTO P
RIGHT JOIN SUPERMERCADO S ON (S.SUP_CNPJ = P.PRO_ID);
       